<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Beat Page</title>

<style>

/* ===== BASE ===== */

body{
margin:0;
font-family:-apple-system,BlinkMacSystemFont,sans-serif;
background:#000;
color:#fff;
display:flex;
justify-content:center;
padding:40px 10px;
}

#app{
width:100%;
max-width:520px;
}

/* ===== GLASS ===== */

.glass{
background:rgba(255,255,255,0.06);
backdrop-filter:blur(25px);
border:1px solid rgba(255,255,255,0.12);
border-radius:22px;
box-shadow:0 10px 40px rgba(0,0,0,.6);
}

/* ===== HERO ===== */

.hero{
overflow:hidden;
position:relative;
margin-bottom:18px;
}

.hero img{
width:100%;
height:320px;
object-fit:cover;
display:block;
}

.hero-overlay{
position:absolute;
bottom:0;
left:0;
right:0;
padding:26px;
background:linear-gradient(transparent,rgba(0,0,0,.85));
}

.hero-overlay h1{
margin:0;
font-size:32px;
}

.hero-overlay p{
margin:6px 0 0;
opacity:.85;
}

/* ===== SOCIAL ===== */

.socials{
display:flex;
gap:10px;
flex-wrap:wrap;
margin-bottom:20px;
}

.socials a{
text-decoration:none;
color:#fff;
padding:10px 16px;
border-radius:12px;
background:rgba(255,255,255,0.08);
transition:.25s;
}

.socials a:hover{
background:rgba(255,255,255,0.18);
}

/* ===== LIST ===== */

.list{
display:flex;
flex-direction:column;
gap:16px;
}

/* ===== BEAT CARD ===== */

.beat{
padding:18px;
transition:.35s;
position:relative;
}

.list:hover .beat{
filter:blur(3px) brightness(.6);
transform:scale(.98);
}

.list .beat:hover{
filter:none;
transform:scale(1.02);
z-index:2;
}

/* ===== TEXT ===== */

.beat-title{
font-size:20px;
font-weight:600;
}

.beat-type{
opacity:.6;
margin-bottom:12px;
}

/* ===== PLAYER ===== */

.player{
display:flex;
align-items:center;
gap:10px;
margin-bottom:12px;
}

.play{
width:36px;
height:36px;
border-radius:50%;
border:none;
cursor:pointer;
background:white;
color:black;
font-weight:bold;
}

.progress{
flex:1;
height:6px;
background:rgba(255,255,255,.15);
border-radius:10px;
overflow:hidden;
cursor:pointer;
}

.progress-bar{
height:100%;
width:0%;
background:white;
}

/* ===== BOTTOM ===== */

.bottom{
display:flex;
justify-content:space-between;
align-items:center;
}

.price{
font-size:14px;
opacity:.85;
}

.buy{
border:none;
padding:10px 18px;
border-radius:12px;
background:white;
color:black;
cursor:pointer;
font-weight:600;
}

footer{
text-align:center;
opacity:.4;
margin-top:20px;
font-size:12px;
}

</style>
</head>

<body>

<div id="app">Loading...</div>

<script>

const CSV_URL="https://docs.google.com/spreadsheets/d/e/2PACX-1vRaW-Jeexk1nvmxlUTk7TAq2akhZW8eY7OxYkgbNcDFyfcOqfyq17_L4w3xRW8cz14JWME0_Fk29hWs/pub?output=csv";

/* ===== CSV PARSER ===== */

function parseCSV(text){
const rows=text.trim().split("\n").map(r=>r.split(","));
const headers=rows[0];

return rows.slice(1).map(row=>{
let obj={};
headers.forEach((h,i)=>obj[h.trim()]=row[i]);
return obj;
});
}

let currentAudio=null;

fetch(CSV_URL)
.then(r=>r.text())
.then(text=>{

const data=parseCSV(text);

/* PROFILE */

const profile=data[0];

const name=profile["Имя"];
const desc=profile["Описание"];
const photo=profile["Фото"];

const telegram=profile["Telegram"];
const instagram=profile["Instagram"];
const youtube=profile["YouTube"];
const vk=profile["VK"];
const buyLink=profile["Купить"];

/* BEATS */

const beats=data.slice(2);

let html=`

<div class="hero glass">
<img src="${photo}">
<div class="hero-overlay">
<h1>${name}</h1>
<p>${desc}</p>
</div>
</div>

<div class="socials">
<a href="${telegram}" target="_blank">Telegram</a>
<a href="${instagram}" target="_blank">Instagram</a>
<a href="${youtube}" target="_blank">YouTube</a>
<a href="${vk}" target="_blank">VK</a>
</div>

<div class="list">
`;

beats.forEach(b=>{

if(!b["Название"]) return;

html+=`
<div class="beat glass">

<div class="beat-title">${b["Название"]}</div>
<div class="beat-type">${b["Type Beat"]}</div>

<div class="player">
<button class="play">▶</button>
<div class="progress"><div class="progress-bar"></div></div>
</div>

<div class="bottom">
<div class="price">
MP3 ${b["MP3"]}₽ | WAV ${b["WAV"]}₽ | EXCL ${b["Exclusive"]}₽
</div>

<button class="buy" onclick="window.open('${buyLink}','_blank')">
Купить
</button>
</div>

<audio src="${b["MP3 Ссылка"]}"></audio>

</div>
`;
});

html+=`</div><footer>Made by BULAVIN</footer>`;

document.getElementById("app").innerHTML=html;

/* PLAYER LOGIC */

document.querySelectorAll(".beat").forEach(card=>{

const audio=card.querySelector("audio");
const play=card.querySelector(".play");
const bar=card.querySelector(".progress-bar");
const progress=card.querySelector(".progress");

play.onclick=()=>{
if(currentAudio && currentAudio!==audio){
currentAudio.pause();
currentAudio.parentElement.querySelector(".play").textContent="▶";
}

audio.paused?audio.play():audio.pause();
play.textContent=audio.paused?"▶":"❚❚";
currentAudio=audio;
};

audio.ontimeupdate=()=>{
bar.style.width=(audio.currentTime/audio.duration*100)+"%";
};

progress.onclick=e=>{
const rect=progress.getBoundingClientRect();
audio.currentTime=((e.clientX-rect.left)/rect.width)*audio.duration;
};

});

});

</script>

</body>
</html>
