<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Beat Page</title>

<style>

/* =========================
   RESET
========================= */

*{
margin:0;
padding:0;
box-sizing:border-box;
font-family:-apple-system,BlinkMacSystemFont,Inter,system-ui,sans-serif;
}

body{
background:#0b0b0c;
color:white;
min-height:100vh;
display:flex;
justify-content:center;
}

/* =========================
   LAYOUT
========================= */

.container{
width:100%;
max-width:720px;
padding:20px 16px 40px;
}

/* =========================
   GLASS SYSTEM
========================= */

.glass{
background:rgba(255,255,255,0.06);
backdrop-filter:blur(22px);
-webkit-backdrop-filter:blur(22px);
border:1px solid rgba(255,255,255,0.08);
border-radius:22px;
box-shadow:
0 10px 30px rgba(0,0,0,.5),
inset 0 1px rgba(255,255,255,.06);
}

/* =========================
   HERO
========================= */

.hero{
position:relative;
overflow:hidden;
margin-bottom:18px;
}

.hero img{
width:100%;
height:320px;
object-fit:cover;
display:block;
}

.hero-overlay{
position:absolute;
bottom:0;
left:0;
right:0;
padding:28px 20px;
background:linear-gradient(
to top,
rgba(0,0,0,.85),
rgba(0,0,0,.35),
transparent
);
}

.hero h1{
font-size:32px;
font-weight:700;
margin-bottom:6px;
}

.hero p{
opacity:.85;
font-size:15px;
}

/* =========================
   SOCIAL BUTTONS
========================= */

.socials{
display:flex;
flex-wrap:wrap;
gap:10px;
margin-bottom:18px;
}

.socials a{
text-decoration:none;
color:white;
padding:10px 18px;
border-radius:14px;
font-size:14px;
background:rgba(255,255,255,.08);
backdrop-filter:blur(16px);
border:1px solid rgba(255,255,255,.08);
transition:.25s;
}

.socials a:hover{
background:rgba(255,255,255,.18);
}

/* =========================
   BEAT CARD
========================= */

.beat{
padding:18px;
margin-bottom:14px;
transition:.35s;
position:relative;
}

.beat:hover{
transform:scale(1.02);
box-shadow:0 20px 40px rgba(0,0,0,.7);
}

.beat-title{
font-size:18px;
font-weight:600;
}

.beat-type{
opacity:.6;
margin-bottom:12px;
font-size:14px;
}

/* =========================
   PLAYER
========================= */

.player{
display:flex;
align-items:center;
gap:12px;
margin:10px 0;
}

.play{
width:38px;
height:38px;
border-radius:50%;
border:none;
cursor:pointer;
background:white;
color:black;
font-weight:bold;
}

.progress{
flex:1;
height:4px;
background:rgba(255,255,255,.2);
border-radius:5px;
position:relative;
cursor:pointer;
}

.progress-bar{
height:100%;
width:0%;
background:white;
border-radius:5px;
}

.time{
font-size:12px;
opacity:.7;
width:42px;
text-align:right;
}

/* =========================
   PRICE + BUY
========================= */

.bottom{
display:flex;
justify-content:space-between;
align-items:center;
margin-top:8px;
flex-wrap:wrap;
gap:10px;
}

.price{
opacity:.85;
font-size:14px;
}

.buy{
padding:10px 18px;
border-radius:14px;
border:none;
background:white;
color:black;
font-weight:600;
cursor:pointer;
}

/* =========================
   HOVER BLUR EFFECT
========================= */

.list:hover .beat:not(:hover){
filter:blur(3px);
opacity:.5;
}

/* ========================= */

.loading{
text-align:center;
opacity:.6;
padding:40px;
}

</style>
</head>

<body>

<div class="container">

<div id="app" class="loading">Loading...</div>

</div>

<script>

/* =========================
   üëâ –í–°–¢–ê–í–¨ –°–í–û–ô CSV
========================= */

const CSV_URL =
"https://docs.google.com/spreadsheets/d/e/2PACX-1vRaW-Jeexk1nvmxlUTk7TAq2akhZW8eY7OxYkgbNcDFyfcOqfyq17_L4w3xRW8cz14JWME0_Fk29hWs/pub?output=csv";

/* ========================= */

let currentAudio=null;

function parseCSV(text){
return text.trim().split("\n").map(r=>r.split(","));
}

function formatTime(sec){
if(!sec)return"0:00";
let m=Math.floor(sec/60);
let s=Math.floor(sec%60).toString().padStart(2,"0");
return `${m}:${s}`;
}

fetch(CSV_URL)
.then(r=>r.text())
.then(text=>{

const rows=parseCSV(text);

const name=rows[1][0];
const desc=rows[1][1];
const photo=rows[1][2];

const telegram=rows[1][3];
const instagram=rows[1][4];
const youtube=rows[1][5];
const vk=rows[1][6];
const buyLink=rows[1][7];

let html=`

<div class="hero glass">
<img src="${photo}">
<div class="hero-overlay">
<h1>${name}</h1>
<p>${desc}</p>
</div>
</div>

<div class="socials">
<a href="${telegram}" target="_blank">Telegram</a>
<a href="${instagram}" target="_blank">Instagram</a>
<a href="${youtube}" target="_blank">YouTube</a>
<a href="${vk}" target="_blank">VK</a>
</div>

<div class="list">
`;

for(let i=4;i<rows.length;i++){

let r=rows[i];
if(!r[0]) continue;

html+=`
<div class="beat glass">

<div class="beat-title">${r[0]}</div>
<div class="beat-type">${r[1]}</div>

<div class="player">
<button class="play">‚ñ∂</button>

<div class="progress">
<div class="progress-bar"></div>
</div>

<div class="time">0:00</div>
</div>

<div class="bottom">
<div class="price">
MP3 ${r[2]}‚ÇΩ | WAV ${r[3]}‚ÇΩ | EXCL ${r[4]}‚ÇΩ
</div>

<button class="buy" onclick="window.open('${buyLink}','_blank')">
–ö—É–ø–∏—Ç—å
</button>
</div>

<audio src="${r[5]}"></audio>

</div>
`;
}

html+=`</div>`;

document.getElementById("app").innerHTML=html;

/* PLAYER LOGIC */

document.querySelectorAll(".beat").forEach(card=>{

const audio=card.querySelector("audio");
const playBtn=card.querySelector(".play");
const bar=card.querySelector(".progress-bar");
const progress=card.querySelector(".progress");
const time=card.querySelector(".time");

playBtn.onclick=()=>{

if(currentAudio && currentAudio!==audio){
currentAudio.pause();
currentAudio.parentElement.querySelector(".play").textContent="‚ñ∂";
}

if(audio.paused){
audio.play();
playBtn.textContent="‚ùö‚ùö";
currentAudio=audio;
}else{
audio.pause();
playBtn.textContent="‚ñ∂";
}
};

audio.ontimeupdate=()=>{
bar.style.width=(audio.currentTime/audio.duration*100)+"%";
time.textContent=formatTime(audio.currentTime);
};

progress.onclick=e=>{
const rect=progress.getBoundingClientRect();
const pct=(e.clientX-rect.left)/rect.width;
audio.currentTime=pct*audio.duration;
};

audio.onended=()=>{
playBtn.textContent="‚ñ∂";
};

});

});

</script>

</body>
</html>
